# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.133752214105, 0.133752214105,0.133470869005,0.133470869005,0.0712826656402,0.0657468907483,0.0464558881605,0.045084212737,0.0494429050662,0.0494429050662,0.045084212737,0.045084212737,0.0494429050662,0.0495444741389,0.0494429050662,0.0512883933831,0.0581185498071,0.062951945056,0.062951945056,0.062951945056,0.0640764824475,0.0795903629121,0.0912948512687,0.0910114040772,0.0910433642508,0.095913192198,0.0950380289922,0.0942018803544,0.0901384991829,0.0930726766792,0.0999955904147,0.127449785208,0.130434146026,0.130276846704,0.131028114366,0.130784480197,0.132766431666,0.130170136491,0.127449785208,0.124522886558,0.121120789022,0.121120789022,0.119261501742,0.115143719706,0.109421769806,0.109421769806,0.109073497408,0.101700843247,0.1088968413,0.0988688731764,0.0988688731764,0.0968007517873,0.0927051147917,0.0906465402337,0.0906465402337)
L_hpd_M95=c(0.352106189471, 0.352106189471,0.352469782356,0.352469782356,0.331582825397,0.323469755266,0.260335095916,0.152717051931,0.137226646304,0.136068442619,0.132220603176,0.132220603176,0.136068442619,0.136875388785,0.137693789222,0.142067190201,0.157839294327,0.15980517381,0.159777472473,0.161942022866,0.183145571382,0.216138165532,0.221233777854,0.218394520803,0.218540823221,0.224300538686,0.223324620713,0.223324620713,0.229122289518,0.299238544218,0.330698483421,0.390534624094,0.390534624094,0.39061022076,0.392508661999,0.392508661999,0.392508661999,0.392381068759,0.392508661999,0.392508661999,0.390606618742,0.392508661999,0.392508661999,0.390888003957,0.390888003957,0.396861502435,0.408748104978,0.405267835214,0.418889033659,0.418889033659,0.418889033659,0.418889033659,0.418889033659,0.418889033659,0.418889033659)
M_hpd_m95=c(0.866420423887, 0.866420423887,0.0844640634572,0.0844640634572,0.084609314014,0.0846894862121,0.0848575950216,0.0859787335851,0.0859787335851,0.0859787335851,0.086203493873,0.0859787335851,0.086203493873,0.0864055498613,0.0859787335851,0.0860583813246,0.0826048061472,0.082350657013,0.082247140775,0.0824217139086,0.0823042256569,0.0811999546272,0.0775812836377,0.0755421399473,0.0722425511901,0.0718926243793,0.0713003478512,0.070864216713,0.0681671737687,0.0701576164844,0.0696007660733,0.0696007660733,0.067247367321,0.0680567452869,0.0644496645098,0.0648129981537,0.0622500424035,0.0615568832231,0.0622500424035,0.0619431133767,0.0604951648942,0.0548653082995,0.0538345396248,0.050754581029,0.0471845194973,0.0449920336698,0.0449920336698,0.0449920336698,0.0447606267096,0.0447606267096,0.0447606267096,0.0447606267096,0.0447606267096,0.0447606267096,0.0447606267096)
M_hpd_M95=c(1.48272107853, 1.48272107853,0.137216723182,0.137216723182,0.137216723182,0.137216723182,0.137216723182,0.136915742433,0.135811287788,0.134868334511,0.133792373945,0.132477974042,0.132575145549,0.132575145549,0.130823926261,0.131160387689,0.127637971076,0.127637971076,0.127637971076,0.127637971076,0.128517091734,0.129475860478,0.127391353416,0.128517091734,0.127637971076,0.127598450918,0.127637971076,0.127637971076,0.125175855035,0.127637971076,0.127637971076,0.127637971076,0.12584550721,0.127299153995,0.125175855035,0.127637971076,0.127504169386,0.127637971076,0.130125809538,0.130125809538,0.130148762949,0.130148762949,0.130148762949,0.130148762949,0.130148762949,0.130125809538,0.130125809538,0.130148762949,0.130148762949,0.130148762949,0.130148762949,0.130148762949,0.130148762949,0.130148762949,0.130148762949)
R_hpd_m95=c(-1.22054669102, -1.22054669102,0.0294281822889,0.0294281822889,-0.0435792045552,-0.0444746471781,-0.069443517346,-0.0904316257482,-0.0696143390056,-0.0676714191255,-0.0667664407518,-0.0641316322926,-0.0626049756645,-0.0626049756645,-0.0626049756645,-0.0619977771316,-0.0523193354182,-0.0472181644034,-0.0472181644034,-0.0468996576063,-0.0465996949584,-0.0278682635924,-0.0234981831521,-0.0163915048301,-0.0165036992794,-0.0157147963454,-0.0157147963454,-0.0163915048301,-0.0206739780571,-0.0206739780571,-0.0120670969804,0.0188476231453,0.0328718950043,0.035116658421,0.0341606697711,0.032534266228,0.0330395947237,0.0265611147389,0.0184955035131,0.0184955035131,0.014939296967,0.0104031745851,0.0118743526019,0.00559715238738,0.00615140220409,-0.00553615807408,-0.0046657490453,-0.0060099784917,-0.00859926953762,-0.0161324728203,-0.0161324728203,-0.0161324728203,-0.0108566739917,-0.0148372575568,-0.0148372575568)
R_hpd_M95=c(-0.574935902841, -0.574935902841,0.251929388551,0.251929388551,0.225132720429,0.225080449765,0.163208134878,0.0477811477523,0.0352284505692,0.0352284505692,0.0336384537815,0.0352284505692,0.0352284505692,0.0357114679668,0.0349105939464,0.0394722727046,0.0567465770606,0.0601548341461,0.0601548341461,0.0641295452215,0.0818327637307,0.1193930623,0.118308548391,0.125602564354,0.127001501758,0.131187654892,0.131187654892,0.131187654892,0.136110657925,0.198468402124,0.227053457917,0.290242032636,0.304297022903,0.304244534053,0.304297022903,0.303780167302,0.303780167302,0.300591877829,0.294752435825,0.295936059175,0.294752435825,0.298059775281,0.303780167302,0.303780167302,0.314283635648,0.313102688449,0.325912803387,0.325912803387,0.331331510488,0.335334479351,0.335334479351,0.340185781545,0.348855863311,0.349387829148,0.349387829148)
L_mean=c(0.267712989707, 0.267712989707,0.268064311263,0.268026128188,0.229344938516,0.205632282228,0.110086722206,0.0943050780345,0.0890742513631,0.0886931039739,0.0887282784356,0.0888032467364,0.0888718983284,0.0891078272872,0.0898150381821,0.0918699019713,0.100066693431,0.105266613675,0.105779123325,0.107624079575,0.116418125605,0.146697580761,0.152275456818,0.154167525349,0.154863196149,0.15607279407,0.156283269782,0.156622679955,0.159908347707,0.183304844784,0.203802981465,0.239678233576,0.254183824518,0.259285350435,0.261287662897,0.260053321816,0.258117595915,0.257378608851,0.257006749321,0.256352877238,0.254892250482,0.253889193553,0.25240957916,0.251532099498,0.251245911054,0.252836376203,0.255580460803,0.255152834762,0.256142435559,0.257695979592,0.257538985884,0.257692033222,0.257721841862,0.258046980262,0.258046980262)
M_mean=c(1.15737220809, 1.15737220809,0.10992235734,0.10992235734,0.109866647188,0.109818609842,0.109806023025,0.109548888275,0.109255956429,0.108798728509,0.108225021517,0.107827020407,0.107563854684,0.107403247959,0.106801109848,0.106416542229,0.10626100865,0.106098749725,0.105807769747,0.105681199875,0.105284285474,0.1046525826,0.1042239395,0.103025942987,0.101950643094,0.101329662114,0.101032965689,0.100869680149,0.100731601423,0.100587348737,0.100498605412,0.100491364679,0.100372866692,0.10030046364,0.100018825994,0.0993702748276,0.0988551084812,0.0987394313732,0.0984995874057,0.0984556249699,0.0987585580437,0.100191292415,0.100468194464,0.101148991746,0.102193038685,0.103083042415,0.103065147182,0.103038249888,0.103011570724,0.103011570724,0.103011570724,0.103011570724,0.103011570724,0.103011570724,0.103011570724)
R_mean=c(-0.889659218386, -0.889659218386,0.158141953924,0.158103770848,0.119478291329,0.0958136723864,0.000280699180757,-0.0152438102405,-0.0201817050656,-0.0201056245351,-0.0194967430812,-0.0190237736707,-0.0186919563551,-0.018295420672,-0.0169860716663,-0.0145466402576,-0.00619431521838,-0.000832136049752,-2.8646422202e-05,0.00194287969958,0.0111338401316,0.0420449981606,0.0480515173183,0.0511415823629,0.0529125530552,0.0547431319565,0.0552503040936,0.0557529998058,0.0591767462845,0.0827174960469,0.103304376053,0.139186868897,0.153810957827,0.158984886794,0.161268836903,0.160683046989,0.159262487433,0.158639177478,0.158507161916,0.157897252268,0.156133692439,0.153697901138,0.151941384695,0.150383107752,0.149052872369,0.149753333787,0.152515313621,0.152114584873,0.153130864836,0.154684408868,0.15452741516,0.154680462498,0.154710271138,0.155035409538,0.155035409538)
trans=0.5
age=(0:(55-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.460777937025), xlim = c(-57.75,2.75), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.63099318639), xlim = c(-57.75,2.75), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.34260136012, 0.384326612063), xlim = c(-57.75,2.75), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-57.75,2.75), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()